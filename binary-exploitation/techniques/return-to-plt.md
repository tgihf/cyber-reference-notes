# Return to PLT

> An ELF-specific stack-based buffer overflow exploitation technique that overwrites EIP with the statically available address of one of the executable's PLT functions, triggering its execution.

---

## Bypass Matrix

✔️ Bypasses defense mechanism
❌ Doesn't bypass defense mechanism

| ASLR | NX Bit | Canaries |
| --- | --- | --- |
| ✔️ | ✔️ | ❌ |

---

## Prerequisites

- [ ] You can overflow the stack and reliably overwrite EIP and some space on the stack after it with input you control
- [ ] The ELF uses some useful PLT function
- [ ] The ELF contains strings you can use as arguments to the PLT function

---

## Methodology

1. [[#Choose an exploitable PLT function|Choose an exploitable PLT function within the ELF]]
	- Note its absolute address within the ELF
2. Based on the ELF's architecture, determine the [[linux-calling-conventions|calling convention]]
3. Understand the PLT function's signature
5. [[#Determine the absolute addresses of any arguments|Determine the absolute addresses of any arguments]]
6. Construct the payload
7. Exploit the target

---

## Choose an exploitable PLT function

[[objdump#List an ELF's PLT functions their absolute addresses|List the executable's PLT functions]] and choose one that you'd like to have the ELF call for you. Pay special attention to the `exec*` family of functions, as well as `system`. Note that if these functions aren't given an absolute path to the program to execute, they'll search `$PATH` for it.

---

## Determine the absolute addresses of any arguments

You'll have to leverage strings within the ELF as argument values. There are several ways to look for usable strings.

### Strings from the ELF's .data section

These are reliably usable. See [[objdump#Dump an ELF's data section|here]].

### A particular string

See [[pwntools#Search for all occurrences of a string in an ELF|here]].

### Look for strings in a hexdump of the ELF

1. [[readelf#Determine an ELF's absolute base address|Determine the base address of the ELF]]
2. Use [[xxd#Produce a hexdump of a file|xxd]] to determine the offset of the argument string
3. Absolute address = base address of ELF + offset of the string
4. Confirm the absolute address is correct
	- [[pwntools#Search for all occurrences of a string in an ELF|pwntools]]
	- [[gdb#Print the String at an Address|gdb]]

---

## References

SNRT Red's `utilities.cgi`
