# Binary Exploitation Methodology

1. [[reverse-engineering-methodology|Reverse engineer]] the binary to understand its purpose, functionality, and potential vulnerabilities
2. [[binary-exploitation-methodology#Exploit Development Workflow|Develop an exploit]] for these vulnerabilities

---

## Exploit Development Workflow

Work in progress:

```mermaid
flowchart TD
	YES1[YES]
	NO1[NO]
	YES2[YES]
	NO2[NO]
	YES3[YES]
	NO3[NO]

	stack_canary[Stack canary?]
	leak_stack_canary[Leak and include the canary]
	brute_force_stack_canary[Brute-force and include the canary]

	overwrite_eip[Overwrite instruction pointer?]
	aslr[ASLR enabled?]
	plt[ELF w/ useful PLT functions?]
	return_to_plt[Technique: Return to PLT]
	
	not_enough_space[Too little space for useful shellcode?]
	socket_reuse[Technique: Socket Reuse]
	
	basic_stack_based_buffer_overflow[Technique: Basic stack-based buffer overflow]

	stack_canary --> YES1
	stack_canary --> NO1
	YES1 --> leak_stack_canary --> overwrite_eip
	YES1 --> brute_force_stack_canary --> overwrite_eip
	NO1 --> overwrite_eip
	
	overwrite_eip --> aslr
	aslr --> YES2
	aslr --> NO2
	YES2 --> plt --> return_to_plt
	NO2 --> not_enough_space
	
	not_enough_space --> YES3 --> socket_reuse
	not_enough_space --> NO3 --> basic_stack_based_buffer_overflow
```

---

## Tools

### Decompilers

- .NET: [[decompiling-dotnet]]
- Everything else: [[ghidra]]

### Debuggers

- ELF: [[gdb]], [Evans Debugger](https://github.com/eteran/edb-debugger)
- PE: [[x64dbg]]

### ELF Analysis

- [[file]]
- [[strings]]
- [[objdump]]
- [[readelf]]

### Writing Shellcode

- [[metasm-shell]]

### Writing Exploits

- [[pwntools]]

### Protection Mechanisms

- [[binary-protection-mechanisms]]

---

## Resources

[ir0nstone - Binary Exploitation](https://ir0nstone.gitbook.io/notes/)
