# Windows Service Misconfigurations

Windows services run executables on a schedule or when triggered by an event. Services can run in the security context of any user, including `SYSTEM`. Misconfigurations in these services are common vectors for local privilege escalation and lateral movement.

The most common Windows service misconfigurations are:

- [[sharpup#Check for Modifiable Services|Modifiable Services]]: When a low-privileged user can modify a service that is configured to run by a high-privileged user, they can modify the service to run an arbitrary executable
- [[sharpup#Check for Modifiable Service Binaries|Modifiable Service Binaries]]: When a low-privileged user can write to a high-privileged service's executable, they can swap out the executable for an arbitrary one
- [[sharpup#Check for Modifiable Service Registry Keys|Modifiable Service Registry Keys]]: When a low-privileged user can write to the registry key that contains the path of the service's executable, they can write the path of an arbitrary executable
- [[sharpup#Check for Unquoted Service Binary Paths|Unquoted Service Binary Path]]: When a high-privileged service's executable path is unquoted and contains spaces, a low-privileged user may be able to trick the service into running an arbitrary executable
- [[sharpup#Check for Hijackable DLLs|DLL Hijacking]]: A low-privileged user may be able to leverage DLL hijacking to trigger the high-privileged service executable into running a malicious DLL

---

## Query Services

- [[sc#Query Services]]
- [[wmic#Query Services]]
- [[powershell-services|powershell > Query Services]]

---

## Check the Effective Access to Services

- [[accesschk]]

---

## Determine the Effective Access on a Service Binary or its Folder

- [[icacls]]
- [[powershell-acls]]
