# Dumping LSASS

> [[lsass|LSASS]] is a critical process within Windows that contains credential material for logged in users. Administrative- and SYSTEM-level users are capable of dumping the memory of the [[lsass|LSASS]] process and extracting the credential material within.

---

## SysInternals's `procdump` (Local)

`procdump` is a legitimate tool from Microsoft's [SysInternals Suite](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite) capable of dumping a process's memory. Since `procdump` is a legitimate, Microsoft-signed tool, it isn't flagged by Windows Defender.

However, Windows Defender **will** flag any command lines that invoke `procdump` and include the word `lsass`. This is easy to bypass by determining the LSASS process ID before running `procdump`.

```powershell
$pid = Get-Process -Name lsass
.\procdump.exe -accepteula -mm $pid $OUTPUT_FILENAME
```

--- 

## `crackmapexec` (Remote)

[[crackmapexec#Remotely dump LSA secrets]]

---
 
## References

[LSASS Wikipedia](https://en.wikipedia.org/wiki/Local_Security_Authority_Subsystem_Service#:~:text=Local%20Security%20Authority%20Subsystem%20Service%20(LSASS)%20is%20a%20process%20in,changes%2C%20and%20creates%20access%20tokens.)

[HackTricks Stealing Windows Credentials](https://book.hacktricks.xyz/windows/stealing-credentials)

[Acronis Knowledge Base - procdump with PID](https://kb.acronis.com/content/27931)
