# Token Privilege Exploitation

The current logon session's [[access-tokens|access token]] specifies what privileges it has. Some of these privileges have known privilege escalation vectors.

---

## Token Privilege Escalation Process

1. List the current logon session token's [[windows-situational-awareness#Current Access Token's Attributes SID Groups Privileges|privileges]].
2. For each privilege:
	- If the privilege is `SeImpersonate` or `SeAssignPrimaryToken`, exploit the [[rotten-potato|rotten potato vulnerability]].
	- If the privilege is `SeBackup` or `SeRestore`, you can back up and dump sensitive files ([[backing-up-and-dumping-sam|SAM]] and [[backing-up-and-dumping-ntds.dit|NTDS.dit]] as examples).
	- Else, see if the privilege is in one of the [[token-privilege-exploitation#References|references]] and follow the instructions on how to exploit it.

---

## References

[PayloadsAllTheThings - Windows Privilege Escalation Methodology & Resources - Impersonate Privileges Chart](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#eop---impersonation-privileges)

[HackTricks Windows Privilege Escalation Abusing Tokens](https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/privilege-escalation-abusing-tokens)

[gtworek Priv2Admin](https://github.com/gtworek/Priv2Admin)